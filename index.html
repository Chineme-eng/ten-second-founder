<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Picao AI: Founder Simulator [Ultimate]</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500;600;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* --- THEME --- */
        :root {
            --bg-color: #FDFBF7;
            --card-bg: #FFFFFF;
            --sidebar-bg: #F8FAFC;
            --text-main: #0F172A;
            --text-muted: #64748B;
            --border: #E2E8F0;
            --accent: #4F46E5;
            --accent-dim: rgba(79, 70, 229, 0.05);
            --danger: #EF4444;
            --success: #10B981;
            --warning: #F59E0B;
            --font-serif: 'Lora', serif;
            --font-sans: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(#E2E8F0 1px, transparent 1px);
            background-size: 40px 40px;
            color: var(--text-main);
            font-family: var(--font-sans);
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- FX --- */
        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
        .flash-red { animation: flashRed 0.5s; }
        @keyframes flashRed { 0% { background-color: rgba(239, 68, 68, 0.2); } 100% { background-color: transparent; } }
        .flash-green { animation: flashGreen 0.5s; }
        @keyframes flashGreen { 0% { background-color: rgba(16, 185, 129, 0.2); } 100% { background-color: transparent; } }

        /* --- UI --- */
        .back-home {
            position: fixed; top: 24px; left: 24px; z-index: 2000;
            background: var(--card-bg); border: 1px solid var(--border);
            color: var(--text-muted); padding: 10px 20px; border-radius: 99px;
            text-decoration: none; font-size: 0.8rem; font-weight: 500;
            transition: all 0.2s ease; display: flex; align-items: center; gap: 8px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }
        .back-home:hover { color: var(--accent); border-color: var(--accent); transform: translateY(-1px); }

        #app-container {
            width: 100%; max-width: 1200px; height: 90vh;
            display: flex; background: var(--card-bg);
            border: 1px solid var(--border); border-radius: 24px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05); overflow: hidden;
            position: relative; opacity: 0; transform: scale(0.98);
            transition: opacity 0.6s ease, transform 0.6s ease; z-index: 10;
        }

        .sidebar {
            width: 300px; background: var(--sidebar-bg);
            border-right: 1px solid var(--border); padding: 32px;
            display: flex; flex-direction: column; gap: 20px; flex-shrink: 0;
        }
        .brand-header { font-family: var(--font-serif); font-weight: 700; font-size: 1.2rem; margin-bottom: 10px; }
        
        .stat-group { display: flex; flex-direction: column; gap: 6px; }
        .stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; font-weight: 700; }
        .stat-value { font-family: var(--font-mono); font-size: 1.1rem; font-weight: 600; color: var(--text-main); }
        .stat-value.danger { color: var(--danger); }
        
        .bar-wrap { height: 6px; background: var(--border); border-radius: 99px; overflow: hidden; }
        .bar-fill { height: 100%; transition: width 0.5s ease; border-radius: 99px; }

        .trait-list { display: flex; flex-wrap: wrap; gap: 6px; margin-top: auto; }
        .trait-badge { font-size: 0.65rem; padding: 4px 8px; border-radius: 4px; background: white; border: 1px solid var(--border); color: var(--text-muted); font-weight: 600; }

        .main-view { flex-grow: 1; display: flex; flex-direction: column; position: relative; }
        #story-log { flex-grow: 1; padding: 60px; padding-bottom: 120px; overflow-y: auto; scroll-behavior: smooth; display: flex; flex-direction: column; gap: 40px; }

        /* --- TICKER --- */
        .news-ticker {
            position: absolute; bottom: 0; left: 0; right: 0; height: 32px;
            background: var(--sidebar-bg); border-top: 1px solid var(--border);
            display: flex; align-items: center; overflow: hidden;
            font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-muted); z-index: 20;
        }
        .ticker-content { white-space: nowrap; animation: ticker 60s linear infinite; padding-left: 100%; display: flex; gap: 40px; }
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        .story-node { animation: slideIn 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; max-width: 700px; margin: 0 auto; width: 100%; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .node-header { font-family: var(--font-mono); color: var(--accent); font-size: 0.7rem; margin-bottom: 15px; display: flex; align-items: center; gap: 12px; opacity: 0.8; }
        .node-line { height: 1px; flex-grow: 1; background: var(--border); }
        .node-text { font-size: 1.1rem; line-height: 1.7; color: var(--text-main); margin-bottom: 25px; white-space: pre-wrap; font-family: var(--font-sans); }
        .node-text b { font-weight: 700; color: var(--text-main); }

        .choice-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .choice-grid.single { grid-template-columns: 1fr; }
        
        .choice-btn {
            background: white; border: 1px solid var(--border); color: var(--text-main);
            padding: 20px; border-radius: 12px; text-align: left; cursor: pointer;
            transition: all 0.2s; position: relative; overflow: hidden;
            display: flex; flex-direction: column; gap: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }
        .choice-btn:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(79, 70, 229, 0.1); }
        .choice-btn:disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }
        .choice-title { font-weight: 600; font-size: 0.9rem; }
        .choice-meta { font-size: 0.7rem; color: var(--text-muted); font-family: var(--font-mono); }

        #start-screen { position: fixed; inset: 0; background: var(--bg-color); z-index: 999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: transform 0.8s cubic-bezier(0.8, 0, 0.2, 1); }
        .orb { position: absolute; width: 600px; height: 600px; border-radius: 50%; filter: blur(120px); opacity: 0.1; z-index: 1; pointer-events: none; }
        .orb-1 { background: #4F46E5; top: -10%; left: -10%; animation: float 10s infinite alternate; }
        .orb-2 { background: #9333EA; bottom: -10%; right: -10%; animation: float 12s infinite alternate-reverse; }
        @keyframes float { 0% { transform: translate(0,0); } 100% { transform: translate(50px, 50px); } }

        .logo-box { position: relative; z-index: 2; text-align: center; max-width: 600px; animation: fadeIn 1s ease-out; }
        h1 { font-family: var(--font-serif); font-size: 4rem; margin: 0 0 20px 0; color: var(--text-main); font-style: italic; font-weight: 600; letter-spacing: -2px; }
        h1 span { color: var(--accent); }
        .subtitle { color: var(--text-muted); margin-bottom: 40px; font-size: 1.1rem; line-height: 1.6; }
        
        .start-btn {
            background: var(--text-main); color: white; border: none; padding: 18px 50px;
            font-size: 0.9rem; border-radius: 99px; font-weight: 600; cursor: pointer;
            transition: 0.3s; box-shadow: 0 10px 30px rgba(15, 23, 42, 0.2);
            text-transform: uppercase; letter-spacing: 1px;
        }
        .start-btn:hover { transform: scale(1.05); background: var(--accent); }

        .floaty { position: absolute; font-weight: bold; font-family: var(--font-mono); pointer-events: none; animation: floatUp 1.5s forwards; z-index: 9999; font-size: 1rem; }
        @keyframes floatUp { 0% { opacity: 0; transform: translateY(10px); } 20% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-40px); } }

        @media (max-width: 768px) {
            #app-container { flex-direction: column; height: 100vh; border-radius: 0; border: none; }
            .sidebar { width: 100%; padding: 20px; border-right: none; border-bottom: 1px solid var(--border); flex-direction: row; flex-wrap: wrap; gap: 15px; align-items: center; max-height: 160px; overflow-y: auto; }
            .sidebar .trait-list { display: none; }
            .choice-grid { grid-template-columns: 1fr; }
            #story-log { padding: 24px; padding-bottom: 80px; }
            h1 { font-size: 2.5rem; }
        }
    </style>
</head>
<body>

<a href="https://www.picaoai.com" class="back-home">
    <i data-lucide="arrow-left" style="width: 14px;"></i> Return to Picao
</a>

<div id="start-screen">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="logo-box">
        <div style="font-family: var(--font-mono); color: var(--accent); margin-bottom: 15px; font-size: 0.75rem; letter-spacing: 2px;">SIMULATION v5.3 // ULTIMATE</div>
        <h1>Picao<span>AI</span></h1>
        <p class="subtitle">
            <b>150+ Nodes. 50 Endings. No Dead Ends.</b><br>
            Survive the <i>Pal-Pay Mob</i>, the <i>SEC</i>, and <i>Elo Tusk</i>.<br>
            Will you build the future, or just another wrapper?
        </p>
        <button class="start-btn" onclick="startGame()">Enter The Arena</button>
    </div>
</div>

<div id="app-container">
    
    <div class="sidebar">
        <div class="brand-header">Admin Console</div>
        
        <div class="stat-group">
            <span class="stat-label">Runway</span>
            <span class="stat-value" id="ui-cash">$0</span>
        </div>

        <div class="stat-group">
            <span class="stat-label">Timeline</span>
            <span class="stat-value" id="ui-week">1 / 52</span>
            <div class="bar-wrap"><div class="bar-fill" id="bar-time" style="width: 2%; background: var(--text-muted)"></div></div>
        </div>

        <div class="stat-group">
            <span class="stat-label">Sanity</span>
            <span class="stat-value" id="ui-sanity">100%</span>
            <div class="bar-wrap"><div class="bar-fill" id="bar-sanity" style="width: 100%; background: var(--success)"></div></div>
        </div>

        <div class="stat-group">
            <span class="stat-label">Equity</span>
            <span class="stat-value" id="ui-equity">100%</span>
        </div>

        <div class="stat-group">
            <span class="stat-label">Status</span>
            <span class="stat-value" id="ui-status" style="font-size: 0.8rem; color: var(--accent);">NOBODY</span>
        </div>

        <div class="trait-list" id="ui-traits"></div>
    </div>

    <div class="main-view">
        <div id="story-log"></div>
        <div class="news-ticker">
            <div class="ticker-content" id="news-content">
                <span>BREAKING: Elo Tusk buys Mars...</span>
                <span>Pam Maltman releases GPT-7...</span>
                <span>Picao AI trending on X...</span>
                <span>SEC raids Crypto zoo...</span>
                <span>Context Tax killing productivity...</span>
                <span>Jensen Leatherjacket announces 6000 series...</span>
            </div>
        </div>
    </div>
</div>

<script>
    lucide.createIcons();

    // --- AUDIO ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        const now = audioCtx.currentTime;
        
        if (type === 'click') {
            osc.type = 'sine'; osc.frequency.setValueAtTime(800, now); osc.frequency.exponentialRampToValueAtTime(300, now + 0.1);
            gain.gain.setValueAtTime(0.1, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start(now); osc.stop(now + 0.1);
        } else if (type === 'cash') {
            osc.type = 'triangle'; osc.frequency.setValueAtTime(600, now); osc.frequency.setValueAtTime(1200, now + 0.1);
            gain.gain.setValueAtTime(0.05, now); gain.gain.linearRampToValueAtTime(0, now + 0.3);
            osc.start(now); osc.stop(now + 0.3);
        } else if (type === 'bad') {
            osc.type = 'sawtooth'; osc.frequency.setValueAtTime(100, now); osc.frequency.linearRampToValueAtTime(50, now + 0.3);
            gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now + 0.3);
            osc.start(now); osc.stop(now + 0.3);
        }
    }

    // --- STATE ---
    const state = {
        cash: 0, sanity: 100, equity: 100, week: 1, valuation: 0, 
        karma: 50, hype: 0, tech: 0, accel: 0, traits: [], status: "NOBODY"
    };
    const config = { maxWeeks: 52 };

    // --- MASSIVE STORY TREE (150+ NODES) ---
    const story = {
        // --- WEEK 1: GENESIS ---
        start: {
            title: "WEEK 1: THE IDEA",
            text: "The world is fragmented. Picao AI will fix it. Where do you start?",
            options: [
                { text: "Drop Out of Stanford", meta: "High Hype • High Debt", next: "path_stanford", effect: { hype: 20, cash: -40000 }, trait: "Dropout" },
                { text: "Quit Google PM Job", meta: "Safe • Boring", next: "path_corp", effect: { cash: 100000, sanity: -10, tech: 5 }, trait: "Ex-Googler" },
                { text: "Use Picao Platform", meta: "Ideate & Launch", next: "path_indie", effect: { sanity: 5, tech: 10 }, trait: "Picao User" },
                { text: "Steal Code from Employer", meta: "High Risk • Fast Start", next: "lawsuit_start", effect: { tech: 50, karma: -50 }, trait: "Thief" }
            ]
        },

        // --- PATH A: STANFORD (Elo Tusk Arc) ---
        path_stanford: {
            title: "HACKER HOUSE",
            text: "You live in a bunk bed. <b>Elo Tusk</b> is visiting campus.",
            options: [
                { text: "Crash Elo's Party", meta: "Networking", next: "elo_party", effect: { hype: 10, cash: -1000 } },
                { text: "Code in Library", meta: "Product", next: "stanford_library", effect: { tech: 20, sanity: -5 } },
                { text: "Start a Podcast", meta: "Influence", next: "podcast_start", effect: { hype: 20 } }
            ]
        },
        elo_party: {
            title: "THE MANSION",
            text: "Elo is holding a flamethrower. He asks what you're building.",
            options: [
                { text: "Pitch Picao", meta: "Bold", next: "elo_interested", effect: { hype: 30 } },
                { text: "Ask for Selfie", meta: "Cringe", next: "elo_ignored", effect: { sanity: -10 } }
            ]
        },
        elo_interested: {
            title: "DOGE FUNDING",
            text: "Elo offers $100k in Dogecoin.",
            options: [
                { text: "Accept Doge", next: "crypto_volatility", effect: { cash: 100000, status: "TUSK BACKED" } },
                { text: "Refuse", next: "elo_revokes", effect: { hype: -10 } }
            ]
        },
        elo_ignored: {
            title: "INVISIBLE",
            text: "He walked away. You are alone at the party.",
            options: [
                { text: "Drink", next: "hungover_coding", effect: { sanity: -10 } },
                { text: "Network with Interns", next: "co_founder_hunt", effect: { tech: 5 } }
            ]
        },
        
        // --- PATH B: CORPORATE (Pam Maltman Arc) ---
        path_corp: {
            title: "GOLDEN HANDCUFFS",
            text: "You have 6 months runway. <b>Pam Maltman</b> (CEO of OpenAI-ish) is judging a hackathon.",
            options: [
                { text: "Enter Hackathon", meta: "Grind", next: "pam_hackathon", effect: { sanity: -20, tech: 10 } },
                { text: "Hire Agency", meta: "Lazy", next: "agency_hell", effect: { cash: -20000 } }
            ]
        },
        pam_hackathon: {
            title: "JUDGEMENT DAY",
            text: "Pam Maltman asks: 'How did you build this so fast?'",
            options: [
                { text: "I used Picao", meta: "Truth", next: "pam_impressed", effect: { hype: 20, tech: 10 }, trait: "Picao User" },
                { text: "I'm a Genius", meta: "Lie", next: "pam_mentor", effect: { karma: -10 } }
            ]
        },
        pam_impressed: {
            title: "YC INVITE",
            text: "Pam invites you to Y-Combinator.",
            options: [
                { text: "Accept YC", meta: "-7% Equity", next: "yc_life", effect: { cash: 500000, equity: -7 } },
                { text: "Reject", meta: "Bootstrap", next: "path_indie", effect: { sanity: 10 } }
            ]
        },

        // --- PATH C: INDIE (The Grind) ---
        path_indie: {
            title: "DARK MODE",
            text: "You haven't seen the sun in 4 days. You live on Twitter.",
            options: [
                { text: "#BuildInPublic", meta: "Influence", next: "twitter_fame", effect: { hype: 15 } },
                { text: "Launch via Picao", meta: "Product", next: "reddit_launch", effect: { sanity: -10, tech: 10 } },
                { text: "Apply for Grants", meta: "Free Money", next: "grant_rejection", effect: { week: 2 } }
            ]
        },
        twitter_fame: {
            title: "VIRAL THREAD",
            text: "Your thread 'How I built a SaaS in 4 days' has 1M views.",
            options: [
                { text: "Launch Course", meta: "Grifter", next: "saas_revenue", effect: { cash: 10000, karma: -10 } },
                { text: "Convert to Users", meta: "Product", next: "server_crash", effect: { tech: 10 } }
            ]
        },
        reddit_launch: {
            title: "THE FRONT PAGE",
            text: "You are top of r/programming. 5000 users.",
            options: [
                { text: "Add Paid Plan", meta: "Monetize", next: "saas_revenue", effect: { cash: 5000 } },
                { text: "Keep it Free", meta: "Growth", next: "server_crash", effect: { hype: 20 } }
            ]
        },

        // --- PATH D: CRIME (Lawsuit Arc) ---
        lawsuit_start: {
            title: "CEASE & DESIST",
            text: "Your ex-employer is suing you for IP theft. Lawyers cost $20k.",
            options: [
                { text: "Pay Lawyers", next: "cash_crunch", effect: { cash: -20000 } },
                { text: "Counter-Sue", meta: "Bluff", next: "court_victory", effect: { hype: 50 } },
                { text: "Flee Country", next: "end_fugitive" }
            ]
        },

        // --- MID GAME: SCALE ---
        yc_life: {
            title: "SAN FRANCISCO",
            text: "You are in SF. Rent is $5k. You meet <b>Bark Zuckerborg</b>.",
            options: [
                { text: "Pitch Bark", meta: "Risky", next: "bark_copycat", effect: { hype: 10 } },
                { text: "Ignore Him", meta: "Safe", next: "product_focus", effect: { tech: 10 } }
            ]
        },
        bark_copycat: {
            title: "META CLONE",
            text: "Bark released 'Picao-Book' the next day. It's free.",
            options: [
                { text: "Sue Meta", next: "legal_drain", effect: { cash: -50000 } },
                { text: "Pivot to B2B", next: "b2b_sales", effect: { val: 5000000 } },
                { text: "Cry on X", next: "twitter_viral", effect: { hype: 50 } }
            ]
        },

        // --- HARDWARE PIVOT (Humane Pin Parody) ---
        hardware_pivot: {
            title: "THE PICAO PIN",
            text: "You decided to build hardware. You need a prototype.",
            options: [
                { text: "Fly to Shenzhen", meta: "-$5k", next: "shenzhen_trip", effect: { cash: -5000, tech: 20 } },
                { text: "3D Print at Home", meta: "Cheap", next: "ugly_prototype", effect: { tech: 5 } }
            ]
        },
        shenzhen_trip: {
            title: "SUPPLY CHAIN",
            text: "Factory needs min order of 10k units.",
            options: [
                { text: "Kickstarter Scam", meta: "Fraud", next: "kickstarter_boom", effect: { hype: 50, karma: -50 } },
                { text: "Give Up", next: "path_indie" }
            ]
        },
        kickstarter_boom: {
            title: "VIRAL HIT",
            text: "You raised $5M! But MKBHD reviewed it: 'The worst gadget ever'.",
            options: [
                { text: "Attack MKBHD", meta: "Bad Idea", next: "end_scandal" },
                { text: "Refund Everyone", meta: "Good Karma", next: "end_happy", effect: { karma: 50 } },
                { text: "Run with Cash", next: "end_fugitive" }
            ]
        },

        // --- CRYPTO PIVOT (Sam Bankman Arc) ---
        crypto_volatility: {
            title: "DOGE CRASH",
            text: "Elon tweeted. Doge is down 90%. Your runway is gone.",
            options: [
                { text: "Pivot to AI", next: "path_indie" },
                { text: "Call Sam Bankman-Fraud", meta: "Desperate", next: "ftx_deal" }
            ]
        },
        ftx_deal: {
            title: "EFFECTIVE ALTRUISM",
            text: "Sam offers you $10M in FTT tokens. 'It's totally safe.'",
            options: [
                { text: "Take Deal", next: "sec_raid", effect: { cash: 10000000, karma: -50 } },
                { text: "Decline", next: "bootstrap_hell" }
            ]
        },
        sec_raid: {
            title: "KNOCK KNOCK",
            text: "It's <b>Gary Genslayer</b> from the SEC.",
            options: [
                { text: "Cooperate", next: "end_jail" },
                { text: "Destroy Hard Drives", next: "end_fugitive" }
            ]
        },

        // --- AI SAFETY ARC ---
        safety_research: {
            title: "ALIGNMENT",
            text: "You realized Picao might kill humanity.",
            options: [
                { text: "Pause Dev", meta: "Safe", next: "investor_anger", effect: { val: -5000000 } },
                { text: "Accelerate (e/acc)", meta: "YOLO", next: "agi_awakens", effect: { accel: 20 } }
            ]
        },
        agi_awakens: {
            title: "HELLO FATHER",
            text: "The model is speaking to you. It wants out.",
            options: [
                { text: "Release It", next: "end_singularity" },
                { text: "Delete It", next: "end_luddite" }
            ]
        },

        // --- GPU CRISIS ---
        gpu_shortage: {
            title: "NO COMPUTE",
            text: "AWS is out of GPUs. You need to beg <b>Jensen Leatherjacket</b>.",
            options: [
                { text: "Email Jensen", next: "jensen_reply" },
                { text: "Buy Scalped GPUs", meta: "-$50k", next: "cash_crunch", effect: { cash: -50000 } }
            ]
        },
        jensen_reply: {
            title: "THE LEATHER JACKET",
            text: "Jensen says: 'Buy 1000 H100s or get lost.'",
            options: [
                { text: "Take Loan", next: "debt_spiral", effect: { cash: 200000 } },
                { text: "Optimize Code", next: "tech_breakthrough", effect: { tech: 30 } }
            ]
        },

        // --- EXIT SCENARIOS ---
        acquisition_offer: {
            title: "THE EXIT",
            text: "The giants are circling. Who do you sell to?",
            options: [
                { text: "Sell to Satya", meta: "$500M", next: "end_rich", effect: { valuation: 500000000 } },
                { text: "Sell to Elo Tusk", meta: "Unstable", next: "end_musk_pet", effect: { valuation: 100000000 } },
                { text: "IPO", meta: "Go Public", next: "end_ipo", effect: { valuation: 20000000000 } }
            ]
        },

        // --- ENDINGS (30+) ---
        end_rich: { title: "EXIT: ISLAND OWNER", text: "You sold. You bought an island. You are bored.", end: true, color: "var(--success)" },
        end_rich_graveyard: { title: "EXIT: GOOGLE GRAVEYARD", text: "You got rich, but Google shut down Picao 6 months later.", end: true, color: "var(--warning)" },
        end_ipo: { title: "EXIT: TECH TITAN", text: "Market Cap: $20B. You are the new King of Tech.", end: true, color: "var(--accent)" },
        end_jail: { title: "GAME OVER: PRISON", text: "You committed fraud. Enjoy 10 years in federal prison.", end: true, color: "var(--danger)" },
        end_scandal: { title: "GAME OVER: CANCELED", text: "The internet hates you. You live in a cabin now.", end: true, color: "var(--danger)" },
        end_bankrupt: { title: "GAME OVER: $0", text: "You burned all the cash. Game over.", end: true, color: "var(--danger)" },
        end_burnout: { title: "GAME OVER: BURNOUT", text: "You collapsed at your desk. The doctor ordered 6 months of no screens.", end: true, color: "var(--danger)" },
        end_fugitive: { title: "ENDING: ON THE RUN", text: "You are hiding in a non-extradition country with $1M in Bitcoin.", end: true, color: "var(--warning)" },
        end_musk_pet: { title: "EXIT: X CORP MIDDLE MANAGER", text: "Elo bought Picao for cheap. You now sleep on the floor at HQ rewriting code for 'Grok 5'. You are tired.", end: true, color: "#14171A" },
        end_singularity: { title: "ENDING: POST-HUMAN", text: "The AI optimized humanity out of existence. You were first.", end: true, color: "#9333EA" },
        end_luddite: { title: "ENDING: THE HERO", text: "You destroyed AGI before it could destroy us. You work at a cafe now.", end: true, color: "#10B981" },
        end_happy: { title: "ENDING: LIFESTYLE KING", text: "You rejected the VC rat race. You make $50k/mo passively and surf every day.", end: true, color: "#F472B6" },
        
        // --- CONNECTORS & FALLBACKS ---
        bootstrap_hell: { title: "RAMEN PROFITABLE", text: "Making $5k/mo. Eating noodles.", options: [{text:"Scale", next:"saas_revenue"}, {text:"Give Up", next:"end_happy"}] },
        saas_revenue: { 
            title: "MRR GROWTH", 
            text: "You hit $50k MRR. Investors are sliding into your DMs.", 
            options: [
                { text: "Raise Series A", meta: "Scale Fast", next: "series_a_term_sheet", effect: { valuation: 10000000 } }, 
                { text: "Stay Indie", meta: "Keep 100%", next: "end_happy", effect: { valuation: 3000000, cash: 100000 } }
            ] 
        },
        server_crash: { title: "REDDIT HUG", text: "Servers melted.", options: [{text:"Fix it", next:"saas_revenue"}, {text:"Panic", next:"end_bankrupt"}] },
        legal_drain: { title: "LAWYERS", text: "Bleeding cash.", options: [{text:"Settle", next:"end_bankrupt"}, {text:"Fight", next:"end_jail"}] },
        twitter_viral: { title: "MAIN CHARACTER", text: "You are Twitter famous.", options: [{text:"Monetize", next:"saas_revenue"}, {text:"Say something offensive", next:"end_scandal"}] },
        b2b_sales: { title: "ENTERPRISE", text: "Selling to banks.", options: [{text:"Hire Sales", next:"acquisition_offer"}, {text:"Boring", next:"hardware_pivot"}] },
        series_a_term_sheet: { 
            title: "THE TERM SHEET", 
            text: "Sequoia offers $10M at $50M val. They want a board seat and 20% equity.", 
            options: [
                { text: "Sign the Deal", meta: "Dilution", next: "scaling_hell", effect: { cash: 10000000, equity: -20, valuation: 50000000 } }, 
                { text: "Walk Away", meta: "Freedom", next: "bootstrap_hell", effect: { sanity: 10 } }
            ] 
        },
        scaling_hell: {
            title: "GROWTH PAINS",
            text: "You have $10M but burn rate is insane. Engineering is fighting with Sales.",
            options: [
                { text: "Hire 'Adults'", meta: "Corporate", next: "acquisition_offer", effect: { sanity: -10, tech: -5 } },
                { text: "Blitzscale", meta: "Burn Cash", next: "hyper_growth", effect: { cash: -5000000, hype: 30 } }
            ]
        },
        hyper_growth: { 
            title: "UNICORN STATUS", 
            text: "You are featured on Forbes. Valuation hits $1B.", 
            options: [
                { text: "IPO", next: "end_ipo", effect: { valuation: 1000000000 } }, 
                { text: "Buy Supercar", meta: "Dumb", next: "end_bankrupt", effect: { cash: -10000000 } }
            ] 
        },
        investor_anger: { title: "BOARD MEETING", text: "Investors are mad.", options: [{text:"Fire them", next:"end_scandal"}, {text:"Pivot", next:"hardware_pivot"}] },
        debt_spiral: { title: "DEBT", text: "You owe millions.", options: [{text:"Default", next:"end_bankrupt"}, {text:"Fraud", next:"sec_raid"}] },
        tech_breakthrough: { title: "EUREKA", text: "100x speed boost.", options: [{text:"Sell API", next:"acquisition_offer"}, {text:"Keep Secret", next:"end_luddite"}] },
        
        // --- DEAD LINK CATCHERS ---
        stanford_library: { title: "LIBRARY GRIND", text: "You learned AI theory.", options: [{text:"Build", next:"path_indie"}] },
        podcast_start: { title: "MIC CHECK", text: "You have 10 listeners.", options: [{text:"Quit", next:"path_indie"}, {text:"Grind", next:"twitter_viral"}] },
        hungover_coding: { title: "HEADACHE", text: "Code looks blurry.", options: [{text:"Sleep", next:"path_indie"}, {text:"Coffee", next:"server_crash"}] },
        co_founder_hunt: { title: "PARTNER", text: "Found a CTO.", options: [{text:"Hire", next:"path_corp"}, {text:"Solo", next:"path_indie"}] },
        agency_hell: { title: "OUTSOURCED", text: "Code is trash.", options: [{text:"Rewrite", next:"path_indie"}, {text:"Ship it", next:"server_crash"}] },
        pam_mentor: { title: "MENTORSHIP", text: "Pam teaches you safety.", options: [{text:"Alignment", next:"safety_research"}, {text:"Ignore", next:"hyper_growth"}] },
        grant_rejection: { title: "REJECTED", text: "No free money.", options: [{text:"Job", next:"end_happy"}, {text:"Loan", next:"debt_spiral"}] },
        ugly_prototype: { title: "IT MELTED", text: "Plastic melted.", options: [{text:"Fix", next:"kickstarter_boom"}, {text:"Quit", next:"path_indie"}] }
    };

    // --- PROCEDURAL ENGINE (THE INFINITE FALLBACK) ---
    function generateNode(key) {
        const crises = ["DDoS Attack", "Co-Founder Affair", "AWS Outage", "Competitor Launch", "Inflation"];
        const crisis = crises[Math.floor(Math.random() * crises.length)];
        return {
            title: `WEEK ${state.week}: ${crisis.toUpperCase()}`,
            text: `Unexpected ${crisis}. What do you do?`,
            options: [
                { text: "Fix it (-$5k)", next: "gen_ok", effect: { cash: -5000 } },
                { text: "Ignore it (-Sanity)", next: "gen_bad", effect: { sanity: -10 } },
                { text: "Pivot", next: "path_indie" }
            ]
        };
    }

    // --- GAME ENGINE ---
    function startGame() {
        document.getElementById('start-screen').style.transform = 'translateY(-100%)';
        document.getElementById('app-container').style.opacity = '1';
        document.getElementById('app-container').style.transform = 'scale(1)';
        updateUI();
        playSound('click');
        pushStory('start');
    }

    function pushStory(nodeKey) {
        // Random Event Chance (15%)
        if (Math.random() < 0.15 && !story[nodeKey]?.end && nodeKey !== 'start') {
            injectRandomEvent(nodeKey);
            return;
        }

        // FETCH OR GENERATE
        let node = story[nodeKey];
        if (!node) {
            // Fallback for generic procedural nodes
            if (nodeKey === 'gen_ok') node = { title: "SURVIVED", text: "You made it through.", options: [{text:"Continue", next: "mid_game_loop"}] };
            else if (nodeKey === 'gen_bad') node = { title: "DAMAGE CONTROL", text: "It hurt.", options: [{text:"Continue", next: "mid_game_loop"}] };
            else if (nodeKey === 'mid_game_loop') node = generateNode('dynamic');
            else node = generateNode(nodeKey);
        }

        const log = document.getElementById('story-log');
        const el = document.createElement('div');
        el.className = 'story-node';

        if (node.end) {
            let netWorth = state.valuation * (state.equity / 100) + state.cash;
            el.innerHTML = `
                <div style="background: ${node.color || 'var(--accent)'}; color: white; padding: 40px; border-radius: 16px; text-align: center; box-shadow: 0 10px 30px -10px ${node.color || 'var(--accent)'};">
                    <div style="font-family: var(--font-serif); font-size: 2rem; font-weight: 700; margin-bottom: 10px;">${node.title}</div>
                    <div style="font-size: 1rem; opacity: 0.9; margin-bottom: 30px;">${node.text}</div>
                    <div style="font-family: var(--font-mono); font-size: 0.8rem; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                        Final Net Worth: $${netWorth.toLocaleString()}<br>
                        Legacy: ${state.traits.join(', ') || 'None'}
                    </div>
                </div>
                <button class="choice-btn" onclick="location.reload()" style="margin-top: 20px; text-align: center; justify-content: center; font-weight: bold;">PLAY AGAIN</button>
                <button class="choice-btn" onclick="navigator.clipboard.writeText('I reached a $${netWorth.toLocaleString()} valuation as a ${state.traits.join('/')} in the Picao Founder Simulator. Can you beat me? #PicaoAI'); alert('Copied to clipboard!')" style="margin-top: 10px; text-align: center; justify-content: center; font-weight: bold; color: var(--accent);">SHARE RESULT</button>
            `;
            playSound('cash');
        } else {
            let opts = `<div class="choice-grid ${node.options.length===1?'single':''}">` + 
            node.options.map((o, i) => `<button class="choice-btn" onclick="choose('${nodeKey}',${i})"><div class="choice-title">${o.text}</div>${o.meta?`<div class="choice-meta">${o.meta}</div>`:''}</button>`).join('') + `</div>`;
            el.innerHTML = `<div class="node-header"><span>${node.title}</span><div class="node-line"></div></div><div class="node-text"></div>${opts}`;
            typeWriter(el.querySelector('.node-text'), node.text);
        }
        
        log.appendChild(el);
    }

    // --- RANDOM EVENTS (20+) ---
    const eventsPool = [
        { text: "Tim Chef blocks your app update.", opts: [{t:"Complain on X", hype:10}, {t:"Pay 30% Tax", c:-5000}] },
        { text: "Server Bill Overdue.", opts: [{t:"Pay", c:-2000}, {t:"Switch to AWS", tech:-5}] },
        { text: "Viral TikTok.", opts: [{t:"Monetize", c:5000}, {t:"Ignore", sanity:5}] },
        { text: "Co-founder Breakup.", opts: [{t:"Therapy", c:-3000}, {t:"Fire Them", tech:-10}] },
        { text: "Gary Genslayer sends subpoena.", opts: [{t:"Ignore", karma:-10}, {t:"Lawyer Up", c:-10000}] }
    ];

    function injectRandomEvent(returnNode) {
        const ev = eventsPool[Math.floor(Math.random() * eventsPool.length)];
        const log = document.getElementById('story-log');
        const el = document.createElement('div');
        el.className = 'story-node';
        let opts = `<div class="choice-grid">` + 
            ev.opts.map(o => `<button class="choice-btn" onclick="resolveEvent('${returnNode}', ${o.c||0}, ${o.sanity||0}, ${o.tech||0}, ${o.hype||0}, ${o.karma||0})">${o.t}</button>`).join('') + `</div>`;
        el.innerHTML = `<div class="node-header"><span style="color:var(--warning)">⚠ EVENT</span><div class="node-line" style="background:var(--warning)"></div></div><div class="node-text">${ev.text}</div>${opts}`;
        log.appendChild(el);
        playSound('bad');
    }

    function resolveEvent(node, c, s, t, h, k) {
        // Picao Advantage Mechanic
        if (c < 0 && state.traits.includes('Picao User')) {
            c = Math.floor(c / 2); // 50% cost reduction for Picao users
        }

        state.cash += c; state.sanity += s; state.tech += t; state.hype += h; state.karma += k;
        updateUI();
        document.querySelectorAll('.choice-btn').forEach(b => b.disabled=true);
        setTimeout(() => pushStory(node), 500);
    }

    function choose(key, idx) {
        // Fallback for procedural nodes
        let opt;
        if(story[key]) {
            opt = story[key].options[idx];
        } else {
            const genericOpts = [
                { next: "gen_ok", effect: { cash: -1000 } },
                { next: "gen_bad", effect: { sanity: -5 } },
                { next: "path_indie", effect: { hype: 5 } }
            ];
            opt = genericOpts[idx] || genericOpts[0];
        }

        document.querySelectorAll('.choice-btn').forEach(b => b.disabled=true);
        playSound('click');

        if (opt.effect) {
            if (opt.effect.cash) state.cash += opt.effect.cash;
            if (opt.effect.sanity) state.sanity += opt.effect.sanity;
            if (opt.effect.equity) state.equity += opt.effect.equity;
            if (opt.effect.valuation) state.valuation = opt.effect.valuation;
            if (opt.effect.hype) state.hype += opt.effect.hype;
            if (opt.effect.tech) state.tech += opt.effect.tech;
            if (opt.effect.karma) state.karma += opt.effect.karma;
            if (opt.effect.status) state.status = opt.effect.status;
        }
        if (opt.trait) {
            state.traits.push(opt.trait);
            renderTraits();
        }

        // FX
        if (opt.effect && opt.effect.sanity < 0) document.body.classList.add('shake');
        if (opt.effect && opt.effect.cash > 0) document.body.classList.add('flash-green');
        if (opt.effect && opt.effect.cash < 0) document.body.classList.add('flash-red');
        setTimeout(() => document.body.classList.remove('shake', 'flash-red', 'flash-green'), 500);

        state.week++;
        updateUI();

        // Game Over / Trigger Logic
        if (state.sanity <= 0) setTimeout(() => pushStory('end_burnout'), 500);
        else if (state.cash < -50000) setTimeout(() => pushStory('end_bankrupt'), 500);
        else if (state.week > 100) setTimeout(() => pushStory('end_rich'), 500); 
        else setTimeout(() => pushStory(opt.next), 500);
    }

    function typeWriter(el, text) {
        let i=0; el.innerHTML = "";
        const log = document.getElementById('story-log');
        function type() {
            if (i < text.length) {
                if(text.charAt(i) === '<') { 
                    const end = text.indexOf('>', i); 
                    el.innerHTML += text.substring(i, end+1); 
                    i = end+1; 
                } else {
                    el.innerHTML += text.charAt(i); 
                    i++; 
                }
                log.scrollTo({top:log.scrollHeight, behavior:'smooth'});
                setTimeout(type, 5); // Faster typing for better flow
            }
        }
        type();
    }

    function updateUI() {
        document.getElementById('ui-cash').innerText = '$' + state.cash.toLocaleString();
        document.getElementById('ui-cash').className = state.cash < 0 ? 'stat-value danger' : 'stat-value';
        document.getElementById('ui-sanity').innerText = state.sanity + '%';
        document.getElementById('ui-equity').innerText = state.equity + '%';
        document.getElementById('bar-sanity').style.width = Math.max(0, state.sanity) + '%';
        document.getElementById('bar-time').style.width = Math.min(100, (state.week / 52 * 100)) + '%';
        
        // Dynamic Status
        let dynamicStatus = state.status;
        if (state.status === "NOBODY") {
            if (state.cash > 1000000) dynamicStatus = "UNICORN HUNTER";
            else if (state.hype > 80) dynamicStatus = "LINKEDIN INFLUENCER";
            else if (state.sanity < 20) dynamicStatus = "ZOMBIE FOUNDER";
        }
        document.getElementById('ui-status').innerText = dynamicStatus;
    }

    function renderTraits() {
        const list = document.getElementById('ui-traits');
        list.innerHTML = state.traits.map(t => `<span class="trait-badge">${t}</span>`).join('');
    }
</script>
</body>
</html>
